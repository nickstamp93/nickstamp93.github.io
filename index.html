<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="page-title">Developer Portfolio</title>
    <meta id="meta-description" name="description" content="Developer portfolio." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg-shape bg-shape-a" aria-hidden="true"></div>
    <div class="bg-shape bg-shape-b" aria-hidden="true"></div>

    <header class="site-header">
      <a class="brand" href="#top" id="brand-name">Developer</a>
      <nav class="site-nav" aria-label="Main">
        <a href="#projects">Projects</a>
        <a href="#stack">Stack</a>
        <a href="#timeline">Timeline</a>
        <a href="#contact">Contact</a>
      </nav>
    </header>

    <main id="top" class="page">
      <section class="hero reveal">
        <p class="eyebrow" id="hero-eyebrow">Developer Portfolio</p>
        <h1>
          <span id="hero-heading">I build clean, fast products</span>
        </h1>
        <p class="hero-copy" id="hero-copy"></p>
        <div class="hero-actions">
          <a class="btn btn-primary" href="#projects">View Projects</a>
          <a class="btn btn-secondary" href="#" id="hero-contact-link">Contact Me</a>
          <a class="btn btn-ghost" href="#" id="hero-resume-link" aria-label="Open resume">Resume</a>
        </div>
      </section>

      <section id="projects" class="section reveal">
        <div class="section-head">
          <h2>Featured Projects</h2>
          <p>Android-first products, multiplatform apps, and supporting web experiences.</p>
        </div>
        <div class="cards" id="projects-list"></div>
      </section>

      <section id="stack" class="section reveal">
        <div class="section-head">
          <h2>Tech Stack</h2>
          <p>Core technologies I use for Android, multiplatform, and web delivery.</p>
        </div>
        <div class="pill-grid" id="stack-list"></div>
      </section>

      <section id="timeline" class="section reveal">
        <div class="section-head">
          <h2>Experience Timeline</h2>
          <p>Highlights from recent engineering work.</p>
        </div>
        <div class="timeline" id="timeline-list"></div>
      </section>

      <section id="contact" class="section contact reveal">
        <div>
          <h2>Let’s build something useful.</h2>
          <p id="contact-pitch"></p>
        </div>
        <div class="contact-actions">
          <a class="btn btn-secondary" href="#" id="contact-github-link" target="_blank" rel="noreferrer">GitHub</a>
          <a class="btn btn-secondary" href="#" id="contact-linkedin-link" target="_blank" rel="noreferrer">LinkedIn</a>
          <a class="btn btn-primary contact-email-btn" href="#" id="contact-email-link">you@example.com</a>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <p>© <span id="year"></span> <span id="footer-name">Developer</span>. <span id="footer-tagline">Built for GitHub Pages.</span></p>
    </footer>

    <script src="site.config.js"></script>
    <script>
      const config = window.SITE_CONFIG || {};
      const flags = config.flags || {};
      const profile = config.profile || {};
      const links = config.links || {};

      const setText = (id, value) => {
        const el = document.getElementById(id);
        if (el && value) el.textContent = value;
      };

      const setLink = (id, href, text) => {
        const el = document.getElementById(id);
        if (!el || !href) return;
        el.href = href;
        if (text) el.textContent = text;
      };

      const toggleSection = (sectionId, shouldShow) => {
        const section = document.getElementById(sectionId);
        const navLink = document.querySelector(`.site-nav a[href="#${sectionId}"]`);
        if (section) section.hidden = !shouldShow;
        if (navLink) navLink.hidden = !shouldShow;
      };

      const toggleElement = (id, shouldShow) => {
        const el = document.getElementById(id);
        if (el) el.hidden = !shouldShow;
      };

      const displayName = profile.name || "Developer";
      const title = profile.title || "Portfolio";

      document.title = `${displayName} | ${title}`;
      const metaDescription = document.getElementById("meta-description");
      if (metaDescription && profile.description) {
        metaDescription.setAttribute("content", profile.description);
      }

      setText("brand-name", displayName);
      setText("hero-eyebrow", profile.eyebrow);
      setText("hero-heading", profile.heroHeading);
      setText("hero-copy", profile.heroCopy);
      setText("contact-pitch", profile.contactPitch);
      setText("footer-name", displayName);
      setText("footer-tagline", profile.footerTagline);

      if (links.email) {
        setLink("hero-contact-link", `mailto:${links.email}`);
        setLink("contact-email-link", `mailto:${links.email}`, links.email);
      }
      setLink("hero-resume-link", links.resume);
      setLink("contact-github-link", links.github);
      setLink("contact-linkedin-link", links.linkedin);

      const projects = [...(config.projects || [])].sort(
        (a, b) => (b.userBaseK || 0) - (a.userBaseK || 0)
      );
      const derivedStack = [
        ...new Set(
          projects.flatMap((project) =>
            Array.isArray(project.tags) ? project.tags : []
          )
        )
      ];
      const stack = (config.stack || []).length > 0 ? config.stack : derivedStack;
      const timeline = config.timeline || [];

      const showProjects = flags.projects !== false && projects.length > 0;
      const showStack = flags.stack !== false && stack.length > 0;
      const showTimeline = flags.timeline !== false && timeline.length > 0;
      const showResumeButton = flags.resumeButton !== false && Boolean(links.resume);

      toggleSection("projects", showProjects);
      toggleSection("stack", showStack);
      toggleSection("timeline", showTimeline);
      toggleElement("hero-resume-link", showResumeButton);

      const projectsList = document.getElementById("projects-list");
      projects.forEach((project) => {
        const article = document.createElement("article");
        article.className = "card";
        article.innerHTML = `
          <div class="card-head">
            <img class="card-logo" src="${project.logo || "https://placehold.co/512x512"}" alt="${project.title || "Project"} logo" loading="lazy" />
            <h3>${project.title || ""}</h3>
            ${project.userBaseK ? `<span class="card-users">${project.userBaseK}K users</span>` : ""}
          </div>
          <p>${project.description || ""}</p>
          <ul class="meta">
            ${(project.tags || []).map((tag) => `<li>${tag}</li>`).join("")}
          </ul>
          <a href="${project.link || "#"}" class="card-link" target="_blank" rel="noreferrer">${project.linkLabel || "View Project"}</a>
        `;
        projectsList.appendChild(article);
      });

      const stackList = document.getElementById("stack-list");
      stack.forEach((item) => {
        const pill = document.createElement("span");
        pill.textContent = item;
        stackList.appendChild(pill);
      });

      const timelineList = document.getElementById("timeline-list");
      timeline.forEach((item) => {
        const article = document.createElement("article");
        article.innerHTML = `
          <h3>${item.role || ""}</h3>
          <p class="time">${item.period || ""}</p>
          <p>${item.description || ""}</p>
        `;
        timelineList.appendChild(article);
      });

      document.getElementById("year").textContent = new Date().getFullYear();
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("show");
            }
          });
        },
        { threshold: 0.1 }
      );
      document.querySelectorAll(".reveal").forEach((el) => observer.observe(el));
    </script>
  </body>
</html>
